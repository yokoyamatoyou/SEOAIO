### フェーズ運用ルール（全体共通）

- 記録: すべての作業は `docs/PROGRESS_LOG.md` に追記する（日時・内容・結果・次アクション）。
- エラーチェック: 各フェーズの完了条件に「自動テスト」「手動スモークテスト」「ビルド/デプロイ検証」を必ず含める。
- UI/UXレビュー: 各フェーズでデザイナー視点・ユーザー視点のチェックを実施（`docs/CHECKLISTS.md` を使用）。
- 依存の安定性: 依存は固定バージョン（`requirements.txt`）で維持。変更時は影響分析とテスト必須。
- 再現性: ローカル（`MVP/`）とクラウド（`GCPSEO/`）の両方で再現可能な手順を維持。

---

### フェーズ0: ドキュメント健全化・方針確立

- 目的: 仕様／方針の可視化と記録運用の開始
- 作業:
  - `AGENT.txt` の文字コード/体裁確認、必要に応じ `docs/` へ移行
  - 本ファイル（ルール）、チェックリスト、ログの整備
- エラーチェック:
  - 既存テスト実行（ユニット）
  - 依存のインストール検証（ローカル）
- UI/UXチェック（デザイナー/ユーザー）:
  - 画面構成の把握と初期ヒューリスティック評価（配色/余白/情報階層/対比）
- 完了条件:
  - `docs/` 整備完了、`PROGRESS_LOG.md` 初回記入、テストがGREENもしくは既知のskipを記録

### フェーズ1: ロジック/UI分離とテスト容易性向上

- 目的: UI依存を分離し、ユニットテストの安定実行を可能にする
- 作業:
  - `SEOAIOAnalyzer` を `core/` に移動してUI依存を排除
  - `seo_aio_streamlit.py` はUI層へ限定
  - import時の `sys.exit(1)` を撤廃し例外に統一
  - テストのskip削減
- エラーチェック:
  - ユニットテスト全件実行、skip削減をログ化
  - ローカル起動のスモークテスト（トップ画面表示/URL入力→分析）
- UI/UXチェック:
  - 初期画面の分かりやすさ・ガイダンス・エラー表示
  - 主要操作の一貫性（ボタン/入力/タブ）
- 完了条件:
  - テスト成功（既知の外部依存を除く）とUIの基本回遊の確認

### フェーズ2: エラーハンドリング/回復性強化

- 目的: API/ネットワーク/JSONの失敗に強い実装
- 作業:
  - OpenAI呼び出しのタイムアウト/リトライ/フォールバック整備
  - JSON抽出・バリデーションの強化
  - ログ/トレース改善
- エラーチェック:
  - 例外系ユニットテスト（モック）
  - スモークテスト（APIキー欠如/タイムアウト時の挙動）
- UI/UXチェック:
  - 失敗時のユーザー向けメッセージ・再試行導線・状態保持
- 完了条件:
  - 代表的な失敗モードでのUXとログが適切

### フェーズ3: クラウド最適化（GCP/Cloud Run）

- 目的: 安定デプロイと基本の可観測性
- 作業:
  - コンテナサイズ最適化、フォント/日本語表示の確認
  - リソース/タイムアウト/同時数の設定指針をREADME追記
  - 構造化ログの出力（任意）
- エラーチェック:
  - Cloud Build/Run でのビルド/起動確認
  - 公開URLでのスモークテスト
- UI/UXチェック:
  - 初回アクセスの体感速度、ローディング表示、PDF出力の確認
- 完了条件:
  - 最小構成の本番同等デプロイが成功

### フェーズ4: CI/品質ゲート

- 目的: 継続的な品質担保
- 作業:
  - 簡易CI（lint+unit）導入
  - 依存の脆弱性チェック（任意）
- エラーチェック:
  - CIでの自動テストGREEN
- UI/UXチェック:
  - 主要ユーザーフローの回帰確認（簡易手順）
- 完了条件:
  - PR駆動で品質ゲートが機能



